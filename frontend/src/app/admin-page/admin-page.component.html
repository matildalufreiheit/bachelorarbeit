<div class="container mt-4">
    <!-- Login-Bereich -->
    <div *ngIf="!isLoggedIn">
      <h2>Login</h2>
      <form (ngSubmit)="login(username.value, password.value)" class="border p-4 rounded shadow-sm">
        <div class="mb-3">
          <label for="username" class="form-label">Benutzername:</label>
          <input id="username" type="text" class="form-control" #username />
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Passwort:</label>
          <input id="password" type="password" class="form-control" #password />
        </div>
        <button type="submit" class="btn btn-primary w-100">Anmelden</button>
      </form>
    </div>
  
    <!-- Admin-Bereich -->
    <div *ngIf="isLoggedIn">
      <h3>Willkommen, Admin!</h3>
      <button (click)="logout()" class="btn btn-danger mb-4">Abmelden</button>
  
      <!-- Aktionswahl -->
      <div class="mb-4">
        <label class="form-label">Aktion wählen:</label>
        <div class="btn-group w-100" role="group">
          <button type="button" class="btn btn-outline-primary" (click)="setMode('neu')">Neu</button>
          <button type="button" class="btn btn-outline-primary" (click)="setMode('ändern')">Ändern</button>
          <button type="button" class="btn btn-outline-primary" (click)="setMode('löschen')">Löschen</button>
          <button type="button" class="btn btn-outline-primary" (click)="setMode('neuerBenutzer')">Neuer Benutzer</button>
        </div>
      </div>
  
      <!-- Modus: Neuer Benutzer -->
      <div *ngIf="mode === 'neuerBenutzer'">
        <h2>Neuen Benutzer registrieren</h2>
        <form (ngSubmit)="register(regUsername.value, regPassword.value)" class="border p-4 rounded shadow-sm">
          <div class="mb-3">
            <label for="regUsername" class="form-label">Benutzername:</label>
            <input id="regUsername" type="text" class="form-control" #regUsername required />
          </div>
          <div class="mb-3">
            <label for="regPassword" class="form-label">Passwort:</label>
            <input id="regPassword" type="password" class="form-control" #regPassword required />
          </div>
          <button type="submit" class="btn btn-primary w-100">Registrieren</button>
        </form>
      </div>
  
      <!-- Modus: Neu -->
      <div *ngIf="mode === 'neu'">
        <h2>Neues Angebot erstellen</h2>
        <form (ngSubmit)="createAngebot(name.value, description.value, url.value)" class="border p-4 rounded shadow-sm">
          <div class="mb-3">
            <label for="name" class="form-label">Name:</label>
            <input id="name" type="text" class="form-control" #name />
          </div>
          <div class="mb-3">
            <label for="description" class="form-label">Beschreibung:</label>
            <textarea id="description" class="form-control" #description></textarea>
          </div>
          <div class="mb-3">
            <label for="url" class="form-label">URL:</label>
            <input id="url" type="url" class="form-control" #url placeholder="https://example.com" />
          </div>
  
          <!-- Tags -->
          <div class="mb-4">
            <mat-form-field appearance="fill" class="w-100">
              <mat-label>Tags auswählen</mat-label>
              <mat-select multiple [(value)]="selectedTags">
                <mat-option *ngFor="let tag of tags" [value]="tag.ID">{{ tag.Tag }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
  
          <!-- Zielgruppen -->
          <div class="mb-4">
            <mat-form-field appearance="fill" class="w-100">
              <mat-label>Zielgruppen auswählen</mat-label>
              <mat-select multiple [(value)]="selectedZielgruppen">
                <mat-option *ngFor="let zielgruppe of zielgruppen" [value]="zielgruppe.ID">{{ zielgruppe.Name }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
  
          <!-- Angebotsart -->
          <div class="mb-4">
            <mat-form-field appearance="fill" class="w-100">
                <mat-label>Angebotsart auswählen</mat-label>
                <mat-select multiple [(value)]="selectedArt">
                    <mat-option *ngFor="let art of arten" [value]="art.ID">
                        {{ art.Art }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
          </div>

          <button type="submit" class="btn btn-success w-100">Erstellen</button>
        </form>
    </div>
  
    <!-- Modus: Ändern -->
    <div *ngIf="mode === 'ändern'">
        <h2>Institution bearbeiten</h2>
        <mat-form-field appearance="fill" class="w-100 mb-4">
          <mat-label>Institution auswählen</mat-label>
            <mat-select
                [(value)]="selectedInstitutionId"
                (selectionChange)="onInstitutionSelected($event.value)">
                <mat-option *ngFor="let institution of institutions" [value]="institution.ID">
                    {{ institution.Name }}
                </mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="selectedInstitution">
            <h3>Details bearbeiten</h3>
            <form>
              <!-- Name -->
              <div class="mb-3">
                <label for="institution-name">Name:</label>
                <input
                  id="institution-name"
                  type="text"
                  [(ngModel)]="selectedInstitution.Name"
                  name="institutionName"
                  class="form-control"
                />
              </div>
          
              <!-- Beschreibung -->
              <div class="mb-3">
                <label for="institution-description">Beschreibung:</label>
                <textarea
                  id="institution-description"
                  [(ngModel)]="selectedInstitution.Beschreibung"
                  name="institutionDescription"
                  class="form-control"
                ></textarea>
              </div>
          
              <!-- URL -->
              <div class="mb-3">
                <label for="institution-url">URL:</label>
                <input
                  id="institution-url"
                  type="text"
                  [(ngModel)]="selectedInstitution.URL"
                  name="institutionURL"
                  class="form-control"
                />
              </div>
          
              <!-- Tags -->
              <div class="mb-4">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Tags auswählen</mat-label>
                  <mat-select multiple [(value)]="selectedTags">
                    <mat-option *ngFor="let tag of tags" [value]="tag.ID">
                      {{ tag.Tag }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
          
              <!-- Zielgruppen -->
              <div class="mb-4">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Zielgruppen auswählen</mat-label>
                  <mat-select multiple [(value)]="selectedZielgruppen">
                    <mat-option *ngFor="let zielgruppe of zielgruppen" [value]="zielgruppe.ID">
                      {{ zielgruppe.Name }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
          
              <!-- Angebotsart -->
              <div class="mb-4">
                <mat-form-field appearance="fill" class="w-100">
                    <mat-label>Angebotsart auswählen</mat-label>
                    <mat-select multiple [(value)]="selectedArt">
                        <mat-option *ngFor="let art of arten" [value]="art.ID">
                            {{ art.Art }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
              </div>
          
              <!-- Speichern -->
              <button type="button" class="btn btn-primary w-100" (click)="saveChanges()">Änderungen speichern</button>
            </form>
          </div>                   
    </div>
  
      <!-- Modus: Löschen -->
      <div *ngIf="mode === 'löschen'">
        <h2>Institution löschen</h2>
        <mat-form-field appearance="fill" class="w-100 mb-4">
          <mat-label>Institution auswählen</mat-label>
          <mat-select [(value)]="selectedInstitutionId">
            <mat-option *ngFor="let institution of institutions" [value]="institution.ID">
              {{ institution.Name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <button type="button" class="btn btn-danger mt-4" (click)="deleteSelectedInstitution()">Institution löschen</button>
    </div>
    </div>
  
    <div class="mt-3">
      <button routerLink="/" class="btn btn-outline-primary">Zurück zur Startseite</button>
    </div>
</div>
  